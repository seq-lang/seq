FASTQ('test/data/seqs.fastq') |> seqs |> echo
# EXPECT: GTGCACAGAAAAAAAGGTTAAATTGAAAAGTAAATATGATAGAAATGATTGCAAATGTTGGCAAACCACTAAATCGACTAAAACTTGAATAAAAGTAAAAATCATCCATGTCATTTATAAAGCGACTCAACTAAAGCATAAGGATATAAGA
# EXPECT: TATATTCGTGTCCACTTCATGATTCCATTCAATTCCATCTAATGTTGATTCCATTTGATTCCATTTGATGATTCAGTTCGATTCCTTGCAATGATTCCCTACGATTCCTTTCTATGATGATTCCATTCGATTCCATTCATTGATGATTTCA
# EXPECT: CCTGCATCACGACGACCGCCGCCACCGTCAGCCCAGCCCACCCACTGCACTCCACCCTCAGCACCACAGTGAGCCCGAATACCACCACCCCCCCCACCACCACCACCACACAAACAACCACCACCACCACAACCACCCTCACCACCATCAC
# EXPECT: TCAATTCGATTCTATTCGATGATGATTCCATTGGATTTCACTTGATGATTCTATTCGATTCCATTCAATGATGATTCACTTCTCGTCCATTGGATGATTCCATTTCATTCCATTCTATGATGATTCCATTCGATTCCATTTGATGATAATT

print '-'  # EXPECT: -
FASTA('test/data/seqs.fasta') |> seqs |> echo
# EXPECT: TCCTCCCCGTTCGCTGGACCCTTGGTCTATCTAGTCAAGAATTAACTCCCATTTAGTTGGCTGTTCGTCGATTACCCCTACTGGACCGTCGCAACGGCTCACGTGGAGGTCTTAGACCAAGAAAGCTACTGTATGCGGGGATATCACATCAGATTGCCAGGCGAGCAGCTCTAGCGTGACACGCCTAGACTCATTCGTTGTTCCTTGTCAATCCCAGGGGTCTCCACAGGGAGTGGATCGAGCTAATCACCGTTTCGAGTCCGTCAGGCGGAGAGTAGCAGTAAGTACAAACTTCTGCTAGTCGCTCTGCCACAACGTAGCCACCTAAGATTAACCCTGGAATTGTCCGGGCGGCATGATCCATCGAGGAGTTAGCGGGGACAGGGAGTTACCAGTCGAGACGTCCATGGTGGTGCTGCAATCCATGGATACCATCTCCTTGCCATTCCTAGGGACATCG
# EXPECT: TATGGGGTAGCATCATTAAGTGGGGAGGTAGACCAGGAGTTCGGTTCCCGGAGTTTCGTTAGTTCAGGTAGCGTGACCTCGTCTTAGTATGCAGTCGTGAAATAATAGACATTTCTGCCTGTCAGGTTGCACTAATCACACCCAGGCTGTTAACGAGGCGGCTCGTAGTATAAACGCTTTGGACTAGACTCGATACCTAGCGGCGCGCATTGATAAATGGTGCATCTATAGTAAAAGGCGTCCCAACCTGGGGACTTAGCGTTGAATACCCGTGCAAGGATCTCTAATCGGTTCTCAATGGCTGCCTGCTCTTTCTCTAAACGAGACTCTAATATCATGTGTGGTCCTTGCTTTCGGTCGAGAAAAAGCCTTTGATCGCATCCCAAACCGACATCTAAAAGCTTCATGTATGTCGGCAGCGAAAAAACGACCAAATAGAAGTCCCCTAACGGAGAATAGGCCGCCCACGACAGAACACCGCTTCGTCCT
# EXPECT: CCCGCTAGCCGTGCCTGATCCTCAACCAAGCTGGGTAAAGACAACCGTCTAATCATTAACTTACGTTGTTACGTCATTTTGCGCTTAAAATTGTCGCACCGGAATCCGTCGAGACTTCCCGAGACATGTCCCCTTAATAAATGTACGGTGTGACCTAACGATCGGATCACCGTCCGTGCTAAAACACACAACCGCTGCGTGACACCGACCGAACGTTACCGAAGGCTGTCCGCCTAACATCTATATTTGGCGGTAAAGAGGCGGTTCCGGCGGACTATAAAGTCACAGGCCACTGTTTCTTTGCAAGATATGGCTCTCTGTCAGGACCGCCCCCTAGGGTCAGCTCAAATAAGCTTGTCCCGGACTCCGTACTTCCAACAGAAAGGTGACCGCTACATTCTGCTATTGACCCCTCACACAACGTTCCCCCGCATGGCGTACGTGTTACCAGGGCGGTTGCGGCCTTACGTCGCCATAAGCACGTATATAAGTCACCCACT
# EXPECT: TGCCGTGACCACCCCGCGAGAATCTCATAATGATATCTCCAATCGAGTA

print '-'  # EXPECT: -
'test/data/seqs.txt' |> seqs |> echo
# EXPECT: GTCCTAAATTGTTGTACGAAAGAACGTGACAGAGGGAAGGCACTCGGCGTGGCTGAGAGTTGCGGCTACCGCACTGTTACACGGTATGCTAGTTAAAACTTGGAAGAGGGCAAAGCGACTATGCACTGTGGCTGGATCGCTATGACCCCTG
# EXPECT: GACGTGTGGAGTAAGCATAAGTCACTATATCAACAAGCCCGCAACAATACTTGTAGAGAATCTGAACCGGCTAGGCGCTCAACGCTACAGGGTGTCATTTCGTACCCCTAACACTGCTATTCGTTTCGGAAGAGGCACCTCGGTGAAGAAA
# EXPECT: GAAGCTGGAGCGAAGTCGATGTTTTTGCTGTACCAGGCGTGAGTTTGTAGATAAGCGGTCTGATACCGCAGAAGCAGGGTACAGTATAGACACGGGTTAAGTCGAGAGACAGGTCAAACAATTAACGCCAAAGAGGTCCCAGTCAGGAGCT
# EXPECT: AATGAAGTGGGGTAATTATGATTCTATAAATTTGTAGGGAAATGGGTTTAGCGCCTGAACGACAAGCGATAGATTATGGGCTGAGGAATAGTAGTTACTCCGCGGGCGGCCGCATTCGATATTTTGCGTCATCATAGATCAAGTTTCCGGG

print '-'  # EXPECT: -
FASTQ('test/data/seqs.fastq.gz') |> seqs |> echo
# EXPECT: GTGCACAGAAAAAAAGGTTAAATTGAAAAGTAAATATGATAGAAATGATTGCAAATGTTGGCAAACCACTAAATCGACTAAAACTTGAATAAAAGTAAAAATCATCCATGTCATTTATAAAGCGACTCAACTAAAGCATAAGGATATAAGA
# EXPECT: TATATTCGTGTCCACTTCATGATTCCATTCAATTCCATCTAATGTTGATTCCATTTGATTCCATTTGATGATTCAGTTCGATTCCTTGCAATGATTCCCTACGATTCCTTTCTATGATGATTCCATTCGATTCCATTCATTGATGATTTCA
# EXPECT: CCTGCATCACGACGACCGCCGCCACCGTCAGCCCAGCCCACCCACTGCACTCCACCCTCAGCACCACAGTGAGCCCGAATACCACCACCCCCCCCACCACCACCACCACACAAACAACCACCACCACCACAACCACCCTCACCACCATCAC
# EXPECT: TCAATTCGATTCTATTCGATGATGATTCCATTGGATTTCACTTGATGATTCTATTCGATTCCATTCAATGATGATTCACTTCTCGTCCATTGGATGATTCCATTTCATTCCATTCTATGATGATTCCATTCGATTCCATTTGATGATAATT

print '-'  # EXPECT: -
'test/data/seqs.txt.gz' |> seqs |> echo
# EXPECT: GTCCTAAATTGTTGTACGAAAGAACGTGACAGAGGGAAGGCACTCGGCGTGGCTGAGAGTTGCGGCTACCGCACTGTTACACGGTATGCTAGTTAAAACTTGGAAGAGGGCAAAGCGACTATGCACTGTGGCTGGATCGCTATGACCCCTG
# EXPECT: GACGTGTGGAGTAAGCATAAGTCACTATATCAACAAGCCCGCAACAATACTTGTAGAGAATCTGAACCGGCTAGGCGCTCAACGCTACAGGGTGTCATTTCGTACCCCTAACACTGCTATTCGTTTCGGAAGAGGCACCTCGGTGAAGAAA
# EXPECT: GAAGCTGGAGCGAAGTCGATGTTTTTGCTGTACCAGGCGTGAGTTTGTAGATAAGCGGTCTGATACCGCAGAAGCAGGGTACAGTATAGACACGGGTTAAGTCGAGAGACAGGTCAAACAATTAACGCCAAAGAGGTCCCAGTCAGGAGCT
# EXPECT: AATGAAGTGGGGTAATTATGATTCTATAAATTTGTAGGGAAATGGGTTTAGCGCCTGAACGACAAGCGATAGATTATGGGCTGAGGAATAGTAGTTACTCCGCGGGCGGCCGCATTCGATATTTTGCGTCATCATAGATCAAGTTTCCGGG

print '-'  # EXPECT: -
FASTQ('test/data/seqs.fastq', copy=False) |> seqs |> echo
# EXPECT: GTGCACAGAAAAAAAGGTTAAATTGAAAAGTAAATATGATAGAAATGATTGCAAATGTTGGCAAACCACTAAATCGACTAAAACTTGAATAAAAGTAAAAATCATCCATGTCATTTATAAAGCGACTCAACTAAAGCATAAGGATATAAGA
# EXPECT: TATATTCGTGTCCACTTCATGATTCCATTCAATTCCATCTAATGTTGATTCCATTTGATTCCATTTGATGATTCAGTTCGATTCCTTGCAATGATTCCCTACGATTCCTTTCTATGATGATTCCATTCGATTCCATTCATTGATGATTTCA
# EXPECT: CCTGCATCACGACGACCGCCGCCACCGTCAGCCCAGCCCACCCACTGCACTCCACCCTCAGCACCACAGTGAGCCCGAATACCACCACCCCCCCCACCACCACCACCACACAAACAACCACCACCACCACAACCACCCTCACCACCATCAC
# EXPECT: TCAATTCGATTCTATTCGATGATGATTCCATTGGATTTCACTTGATGATTCTATTCGATTCCATTCAATGATGATTCACTTCTCGTCCATTGGATGATTCCATTTCATTCCATTCTATGATGATTCCATTCGATTCCATTTGATGATAATT

print '-'  # EXPECT: -
FASTA('test/data/seqs.fasta', copy=False) |> seqs |> echo
# EXPECT: TCCTCCCCGTTCGCTGGACCCTTGGTCTATCTAGTCAAGAATTAACTCCCATTTAGTTGGCTGTTCGTCGATTACCCCTACTGGACCGTCGCAACGGCTCACGTGGAGGTCTTAGACCAAGAAAGCTACTGTATGCGGGGATATCACATCAGATTGCCAGGCGAGCAGCTCTAGCGTGACACGCCTAGACTCATTCGTTGTTCCTTGTCAATCCCAGGGGTCTCCACAGGGAGTGGATCGAGCTAATCACCGTTTCGAGTCCGTCAGGCGGAGAGTAGCAGTAAGTACAAACTTCTGCTAGTCGCTCTGCCACAACGTAGCCACCTAAGATTAACCCTGGAATTGTCCGGGCGGCATGATCCATCGAGGAGTTAGCGGGGACAGGGAGTTACCAGTCGAGACGTCCATGGTGGTGCTGCAATCCATGGATACCATCTCCTTGCCATTCCTAGGGACATCG
# EXPECT: TATGGGGTAGCATCATTAAGTGGGGAGGTAGACCAGGAGTTCGGTTCCCGGAGTTTCGTTAGTTCAGGTAGCGTGACCTCGTCTTAGTATGCAGTCGTGAAATAATAGACATTTCTGCCTGTCAGGTTGCACTAATCACACCCAGGCTGTTAACGAGGCGGCTCGTAGTATAAACGCTTTGGACTAGACTCGATACCTAGCGGCGCGCATTGATAAATGGTGCATCTATAGTAAAAGGCGTCCCAACCTGGGGACTTAGCGTTGAATACCCGTGCAAGGATCTCTAATCGGTTCTCAATGGCTGCCTGCTCTTTCTCTAAACGAGACTCTAATATCATGTGTGGTCCTTGCTTTCGGTCGAGAAAAAGCCTTTGATCGCATCCCAAACCGACATCTAAAAGCTTCATGTATGTCGGCAGCGAAAAAACGACCAAATAGAAGTCCCCTAACGGAGAATAGGCCGCCCACGACAGAACACCGCTTCGTCCT
# EXPECT: CCCGCTAGCCGTGCCTGATCCTCAACCAAGCTGGGTAAAGACAACCGTCTAATCATTAACTTACGTTGTTACGTCATTTTGCGCTTAAAATTGTCGCACCGGAATCCGTCGAGACTTCCCGAGACATGTCCCCTTAATAAATGTACGGTGTGACCTAACGATCGGATCACCGTCCGTGCTAAAACACACAACCGCTGCGTGACACCGACCGAACGTTACCGAAGGCTGTCCGCCTAACATCTATATTTGGCGGTAAAGAGGCGGTTCCGGCGGACTATAAAGTCACAGGCCACTGTTTCTTTGCAAGATATGGCTCTCTGTCAGGACCGCCCCCTAGGGTCAGCTCAAATAAGCTTGTCCCGGACTCCGTACTTCCAACAGAAAGGTGACCGCTACATTCTGCTATTGACCCCTCACACAACGTTCCCCCGCATGGCGTACGTGTTACCAGGGCGGTTGCGGCCTTACGTCGCCATAAGCACGTATATAAGTCACCCACT
# EXPECT: TGCCGTGACCACCCCGCGAGAATCTCATAATGATATCTCCAATCGAGTA

print '-'  # EXPECT: -
Seqs('test/data/seqs.txt', copy=False) |> seqs |> echo
# EXPECT: GTCCTAAATTGTTGTACGAAAGAACGTGACAGAGGGAAGGCACTCGGCGTGGCTGAGAGTTGCGGCTACCGCACTGTTACACGGTATGCTAGTTAAAACTTGGAAGAGGGCAAAGCGACTATGCACTGTGGCTGGATCGCTATGACCCCTG
# EXPECT: GACGTGTGGAGTAAGCATAAGTCACTATATCAACAAGCCCGCAACAATACTTGTAGAGAATCTGAACCGGCTAGGCGCTCAACGCTACAGGGTGTCATTTCGTACCCCTAACACTGCTATTCGTTTCGGAAGAGGCACCTCGGTGAAGAAA
# EXPECT: GAAGCTGGAGCGAAGTCGATGTTTTTGCTGTACCAGGCGTGAGTTTGTAGATAAGCGGTCTGATACCGCAGAAGCAGGGTACAGTATAGACACGGGTTAAGTCGAGAGACAGGTCAAACAATTAACGCCAAAGAGGTCCCAGTCAGGAGCT
# EXPECT: AATGAAGTGGGGTAATTATGATTCTATAAATTTGTAGGGAAATGGGTTTAGCGCCTGAACGACAAGCGATAGATTATGGGCTGAGGAATAGTAGTTACTCCGCGGGCGGCCGCATTCGATATTTTGCGTCATCATAGATCAAGTTTCCGGG

print '-'  # EXPECT: -
FASTQ('test/data/seqs.fastq.gz', copy=False) |> seqs |> echo
# EXPECT: GTGCACAGAAAAAAAGGTTAAATTGAAAAGTAAATATGATAGAAATGATTGCAAATGTTGGCAAACCACTAAATCGACTAAAACTTGAATAAAAGTAAAAATCATCCATGTCATTTATAAAGCGACTCAACTAAAGCATAAGGATATAAGA
# EXPECT: TATATTCGTGTCCACTTCATGATTCCATTCAATTCCATCTAATGTTGATTCCATTTGATTCCATTTGATGATTCAGTTCGATTCCTTGCAATGATTCCCTACGATTCCTTTCTATGATGATTCCATTCGATTCCATTCATTGATGATTTCA
# EXPECT: CCTGCATCACGACGACCGCCGCCACCGTCAGCCCAGCCCACCCACTGCACTCCACCCTCAGCACCACAGTGAGCCCGAATACCACCACCCCCCCCACCACCACCACCACACAAACAACCACCACCACCACAACCACCCTCACCACCATCAC
# EXPECT: TCAATTCGATTCTATTCGATGATGATTCCATTGGATTTCACTTGATGATTCTATTCGATTCCATTCAATGATGATTCACTTCTCGTCCATTGGATGATTCCATTTCATTCCATTCTATGATGATTCCATTCGATTCCATTTGATGATAATT

print '-'  # EXPECT: -
Seqs('test/data/seqs.txt.gz', copy=False) |> seqs |> echo
# EXPECT: GTCCTAAATTGTTGTACGAAAGAACGTGACAGAGGGAAGGCACTCGGCGTGGCTGAGAGTTGCGGCTACCGCACTGTTACACGGTATGCTAGTTAAAACTTGGAAGAGGGCAAAGCGACTATGCACTGTGGCTGGATCGCTATGACCCCTG
# EXPECT: GACGTGTGGAGTAAGCATAAGTCACTATATCAACAAGCCCGCAACAATACTTGTAGAGAATCTGAACCGGCTAGGCGCTCAACGCTACAGGGTGTCATTTCGTACCCCTAACACTGCTATTCGTTTCGGAAGAGGCACCTCGGTGAAGAAA
# EXPECT: GAAGCTGGAGCGAAGTCGATGTTTTTGCTGTACCAGGCGTGAGTTTGTAGATAAGCGGTCTGATACCGCAGAAGCAGGGTACAGTATAGACACGGGTTAAGTCGAGAGACAGGTCAAACAATTAACGCCAAAGAGGTCCCAGTCAGGAGCT
# EXPECT: AATGAAGTGGGGTAATTATGATTCTATAAATTTGTAGGGAAATGGGTTTAGCGCCTGAACGACAAGCGATAGATTATGGGCTGAGGAATAGTAGTTACTCCGCGGGCGGCCGCATTCGATATTTTGCGTCATCATAGATCAAGTTTCCGGG

print '-'  # EXPECT: -
SAM('test/data/toy.sam') |> seqs |> echo
# EXPECT: TTAGATAAAGAGGATACTG
# EXPECT: AAAAGATAAGGGATAAA
# EXPECT: AGCTAA
# EXPECT: ATAGCTCTCAGC
# EXPECT: TAGGC
# EXPECT: CAGCGCCAT
# EXPECT: AGGTTTTATAAAACAAATAA
# EXPECT: GGTTTTATAAAACAAATAATT
# EXPECT: TTATAAAACAAATAATTAAGTCTACA
# EXPECT: CAAATAATTAAGTCTACAGAGCAAC
# EXPECT: AATAATTAAGTCTACAGAGCAACT
# EXPECT: TAATTAAGTCTACAGAGCAACTA

print '-'  # EXPECT: -
BAM('test/data/toy.bam') |> seqs |> echo
# EXPECT: TTAGATAAAGAGGATACTG
# EXPECT: AAAAGATAAGGGATAAA
# EXPECT: AGCTAA
# EXPECT: ATAGCTCTCAGC
# EXPECT: TAGGC
# EXPECT: CAGCGCCAT
# EXPECT: AGGTTTTATAAAACAAATAA
# EXPECT: GGTTTTATAAAACAAATAATT
# EXPECT: TTATAAAACAAATAATTAAGTCTACA
# EXPECT: CAAATAATTAAGTCTACAGAGCAAC
# EXPECT: AATAATTAAGTCTACAGAGCAACT
# EXPECT: TAATTAAGTCTACAGAGCAACTA

print '-'  # EXPECT: -
CRAM('test/data/toy.cram') |> seqs |> echo
# EXPECT: TTAGATAAAGAGGATACTG
# EXPECT: AAAAGATAAGGGATAAA
# EXPECT: AGCTAA
# EXPECT: ATAGCTCTCAGC
# EXPECT: TAGGC
# EXPECT: CAGCGCCAT
# EXPECT: AGGTTTTATAAAACAAATAA
# EXPECT: GGTTTTATAAAACAAATAATT
# EXPECT: TTATAAAACAAATAATTAAGTCTACA
# EXPECT: CAAATAATTAAGTCTACAGAGCAAC
# EXPECT: AATAATTAAGTCTACAGAGCAACT
# EXPECT: TAATTAAGTCTACAGAGCAACTA

def print1(r):
    print r.name
    print r.read
    print r.qual

print '-'  # EXPECT: -
FASTQ('test/data/seqs.fastq') |> iter |> print1
# EXPECT: SL-HXF:348:HKLFWCCXX:1:2101:15676:57231:CACCAAAAGTACATGA
# EXPECT: GTGCACAGAAAAAAAGGTTAAATTGAAAAGTAAATATGATAGAAATGATTGCAAATGTTGGCAAACCACTAAATCGACTAAAACTTGAATAAAAGTAAAAATCATCCATGTCATTTATAAAGCGACTCAACTAAAGCATAAGGATATAAGA
# EXPECT: AAFFFKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKFKKKKKKKKKKKKKFKKKKKKKFKKFKKKKFKKKFK<,AAAFKFKKFAFKKA,,,A<FFAFFK<AAKFFKKKFK,<,,7F<
# EXPECT: SL-HXF:348:HKLFWCCXX:1:2121:24495:55877:CACCAAAAGTACATGA
# EXPECT: TATATTCGTGTCCACTTCATGATTCCATTCAATTCCATCTAATGTTGATTCCATTTGATTCCATTTGATGATTCAGTTCGATTCCTTGCAATGATTCCCTACGATTCCTTTCTATGATGATTCCATTCGATTCCATTCATTGATGATTTCA
# EXPECT: AAFFFKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKFKKKKKKKKKKKKKKFKKKKKKKKKKKKFKKKKKKKKKFFK7AAFKKFKKKKKFAKKKFKKFKKKF7A7F<<KKF,
# EXPECT: SL-HXF:348:HKLFWCCXX:1:2220:28361:38491:CACCAAAAGTACATGA
# EXPECT: CCTGCATCACGACGACCGCCGCCACCGTCAGCCCAGCCCACCCACTGCACTCCACCCTCAGCACCACAGTGAGCCCGAATACCACCACCCCCCCCACCACCACCACCACACAAACAACCACCACCACCACAACCACCCTCACCACCATCAC
# EXPECT: ,A,<,A,F,,,,,,,,,,(((,,(<((7,A,A,(,((((,,(7,,,,,,F,,FK,F7<,,,7F,FFF7,,,77,,(((,,,7F,FF,A77AF7FK(((,<,<,,,,,<<,,,,,,,<A7AF,7A<KKA<F,,,7,,<(,,,,,,,,,,,,,
# EXPECT: SL-HXF:348:HKLFWCCXX:4:1106:4553:37893:CACCAAAAGTACATGA
# EXPECT: TCAATTCGATTCTATTCGATGATGATTCCATTGGATTTCACTTGATGATTCTATTCGATTCCATTCAATGATGATTCACTTCTCGTCCATTGGATGATTCCATTTCATTCCATTCTATGATGATTCCATTCGATTCCATTTGATGATAATT
# EXPECT: AAFFFKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKFKKKKFKKKKKKFKKK7AFFKAFKKKKK,FKKFKAFFA7<<,FFAFKFAF7FKK77<,,,,,,,,,,<F7A,<AK,AFFK<<KKF<,AA7<F,,7

print '-'  # EXPECT: -
FASTQ('test/data/seqs.fastq.gz') |> iter |> print1
# EXPECT: SL-HXF:348:HKLFWCCXX:1:2101:15676:57231:CACCAAAAGTACATGA
# EXPECT: GTGCACAGAAAAAAAGGTTAAATTGAAAAGTAAATATGATAGAAATGATTGCAAATGTTGGCAAACCACTAAATCGACTAAAACTTGAATAAAAGTAAAAATCATCCATGTCATTTATAAAGCGACTCAACTAAAGCATAAGGATATAAGA
# EXPECT: AAFFFKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKFKKKKKKKKKKKKKFKKKKKKKFKKFKKKKFKKKFK<,AAAFKFKKFAFKKA,,,A<FFAFFK<AAKFFKKKFK,<,,7F<
# EXPECT: SL-HXF:348:HKLFWCCXX:1:2121:24495:55877:CACCAAAAGTACATGA
# EXPECT: TATATTCGTGTCCACTTCATGATTCCATTCAATTCCATCTAATGTTGATTCCATTTGATTCCATTTGATGATTCAGTTCGATTCCTTGCAATGATTCCCTACGATTCCTTTCTATGATGATTCCATTCGATTCCATTCATTGATGATTTCA
# EXPECT: AAFFFKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKFKKKKKKKKKKKKKKFKKKKKKKKKKKKFKKKKKKKKKFFK7AAFKKFKKKKKFAKKKFKKFKKKF7A7F<<KKF,
# EXPECT: SL-HXF:348:HKLFWCCXX:1:2220:28361:38491:CACCAAAAGTACATGA
# EXPECT: CCTGCATCACGACGACCGCCGCCACCGTCAGCCCAGCCCACCCACTGCACTCCACCCTCAGCACCACAGTGAGCCCGAATACCACCACCCCCCCCACCACCACCACCACACAAACAACCACCACCACCACAACCACCCTCACCACCATCAC
# EXPECT: ,A,<,A,F,,,,,,,,,,(((,,(<((7,A,A,(,((((,,(7,,,,,,F,,FK,F7<,,,7F,FFF7,,,77,,(((,,,7F,FF,A77AF7FK(((,<,<,,,,,<<,,,,,,,<A7AF,7A<KKA<F,,,7,,<(,,,,,,,,,,,,,
# EXPECT: SL-HXF:348:HKLFWCCXX:4:1106:4553:37893:CACCAAAAGTACATGA
# EXPECT: TCAATTCGATTCTATTCGATGATGATTCCATTGGATTTCACTTGATGATTCTATTCGATTCCATTCAATGATGATTCACTTCTCGTCCATTGGATGATTCCATTTCATTCCATTCTATGATGATTCCATTCGATTCCATTTGATGATAATT
# EXPECT: AAFFFKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKFKKKKFKKKKKKFKKK7AFFKAFKKKKK,FKKFKAFFA7<<,FFAFKFAF7FKK77<,,,,,,,,,,<F7A,<AK,AFFK<<KKF<,AA7<F,,7

print '-'  # EXPECT: -
FASTQ('test/data/seqs.fastq', gzip=False, validate=False) |> iter |> print1
# EXPECT: SL-HXF:348:HKLFWCCXX:1:2101:15676:57231:CACCAAAAGTACATGA
# EXPECT: GTGCACAGAAAAAAAGGTTAAATTGAAAAGTAAATATGATAGAAATGATTGCAAATGTTGGCAAACCACTAAATCGACTAAAACTTGAATAAAAGTAAAAATCATCCATGTCATTTATAAAGCGACTCAACTAAAGCATAAGGATATAAGA
# EXPECT: AAFFFKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKFKKKKKKKKKKKKKFKKKKKKKFKKFKKKKFKKKFK<,AAAFKFKKFAFKKA,,,A<FFAFFK<AAKFFKKKFK,<,,7F<
# EXPECT: SL-HXF:348:HKLFWCCXX:1:2121:24495:55877:CACCAAAAGTACATGA
# EXPECT: TATATTCGTGTCCACTTCATGATTCCATTCAATTCCATCTAATGTTGATTCCATTTGATTCCATTTGATGATTCAGTTCGATTCCTTGCAATGATTCCCTACGATTCCTTTCTATGATGATTCCATTCGATTCCATTCATTGATGATTTCA
# EXPECT: AAFFFKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKFKKKKKKKKKKKKKKFKKKKKKKKKKKKFKKKKKKKKKFFK7AAFKKFKKKKKFAKKKFKKFKKKF7A7F<<KKF,
# EXPECT: SL-HXF:348:HKLFWCCXX:1:2220:28361:38491:CACCAAAAGTACATGA
# EXPECT: CCTGCATCACGACGACCGCCGCCACCGTCAGCCCAGCCCACCCACTGCACTCCACCCTCAGCACCACAGTGAGCCCGAATACCACCACCCCCCCCACCACCACCACCACACAAACAACCACCACCACCACAACCACCCTCACCACCATCAC
# EXPECT: ,A,<,A,F,,,,,,,,,,(((,,(<((7,A,A,(,((((,,(7,,,,,,F,,FK,F7<,,,7F,FFF7,,,77,,(((,,,7F,FF,A77AF7FK(((,<,<,,,,,<<,,,,,,,<A7AF,7A<KKA<F,,,7,,<(,,,,,,,,,,,,,
# EXPECT: SL-HXF:348:HKLFWCCXX:4:1106:4553:37893:CACCAAAAGTACATGA
# EXPECT: TCAATTCGATTCTATTCGATGATGATTCCATTGGATTTCACTTGATGATTCTATTCGATTCCATTCAATGATGATTCACTTCTCGTCCATTGGATGATTCCATTTCATTCCATTCTATGATGATTCCATTCGATTCCATTTGATGATAATT
# EXPECT: AAFFFKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKFKKKKFKKKKKKFKKK7AFFKAFKKKKK,FKKFKAFFA7<<,FFAFKFAF7FKK77<,,,,,,,,,,<F7A,<AK,AFFK<<KKF<,AA7<F,,7

def print2(r):
    print r.name
    print r.seq

print '-'  # EXPECT: -
FASTA('test/data/seqs.fasta') |> iter |> print2
# EXPECT: chrA
# EXPECT: TCCTCCCCGTTCGCTGGACCCTTGGTCTATCTAGTCAAGAATTAACTCCCATTTAGTTGGCTGTTCGTCGATTACCCCTACTGGACCGTCGCAACGGCTCACGTGGAGGTCTTAGACCAAGAAAGCTACTGTATGCGGGGATATCACATCAGATTGCCAGGCGAGCAGCTCTAGCGTGACACGCCTAGACTCATTCGTTGTTCCTTGTCAATCCCAGGGGTCTCCACAGGGAGTGGATCGAGCTAATCACCGTTTCGAGTCCGTCAGGCGGAGAGTAGCAGTAAGTACAAACTTCTGCTAGTCGCTCTGCCACAACGTAGCCACCTAAGATTAACCCTGGAATTGTCCGGGCGGCATGATCCATCGAGGAGTTAGCGGGGACAGGGAGTTACCAGTCGAGACGTCCATGGTGGTGCTGCAATCCATGGATACCATCTCCTTGCCATTCCTAGGGACATCG
# EXPECT: chrB
# EXPECT: TATGGGGTAGCATCATTAAGTGGGGAGGTAGACCAGGAGTTCGGTTCCCGGAGTTTCGTTAGTTCAGGTAGCGTGACCTCGTCTTAGTATGCAGTCGTGAAATAATAGACATTTCTGCCTGTCAGGTTGCACTAATCACACCCAGGCTGTTAACGAGGCGGCTCGTAGTATAAACGCTTTGGACTAGACTCGATACCTAGCGGCGCGCATTGATAAATGGTGCATCTATAGTAAAAGGCGTCCCAACCTGGGGACTTAGCGTTGAATACCCGTGCAAGGATCTCTAATCGGTTCTCAATGGCTGCCTGCTCTTTCTCTAAACGAGACTCTAATATCATGTGTGGTCCTTGCTTTCGGTCGAGAAAAAGCCTTTGATCGCATCCCAAACCGACATCTAAAAGCTTCATGTATGTCGGCAGCGAAAAAACGACCAAATAGAAGTCCCCTAACGGAGAATAGGCCGCCCACGACAGAACACCGCTTCGTCCT
# EXPECT: chrC
# EXPECT: CCCGCTAGCCGTGCCTGATCCTCAACCAAGCTGGGTAAAGACAACCGTCTAATCATTAACTTACGTTGTTACGTCATTTTGCGCTTAAAATTGTCGCACCGGAATCCGTCGAGACTTCCCGAGACATGTCCCCTTAATAAATGTACGGTGTGACCTAACGATCGGATCACCGTCCGTGCTAAAACACACAACCGCTGCGTGACACCGACCGAACGTTACCGAAGGCTGTCCGCCTAACATCTATATTTGGCGGTAAAGAGGCGGTTCCGGCGGACTATAAAGTCACAGGCCACTGTTTCTTTGCAAGATATGGCTCTCTGTCAGGACCGCCCCCTAGGGTCAGCTCAAATAAGCTTGTCCCGGACTCCGTACTTCCAACAGAAAGGTGACCGCTACATTCTGCTATTGACCCCTCACACAACGTTCCCCCGCATGGCGTACGTGTTACCAGGGCGGTTGCGGCCTTACGTCGCCATAAGCACGTATATAAGTCACCCACT
# EXPECT: chrD
# EXPECT: TGCCGTGACCACCCCGCGAGAATCTCATAATGATATCTCCAATCGAGTA

print '-'  # EXPECT: -
FASTA('test/data/seqs.fasta', gzip=False, copy=False, validate=False, fai=False) |> iter |> print2
# EXPECT: chrA
# EXPECT: TCCTCCCCGTTCGCTGGACCCTTGGTCTATCTAGTCAAGAATTAACTCCCATTTAGTTGGCTGTTCGTCGATTACCCCTACTGGACCGTCGCAACGGCTCACGTGGAGGTCTTAGACCAAGAAAGCTACTGTATGCGGGGATATCACATCAGATTGCCAGGCGAGCAGCTCTAGCGTGACACGCCTAGACTCATTCGTTGTTCCTTGTCAATCCCAGGGGTCTCCACAGGGAGTGGATCGAGCTAATCACCGTTTCGAGTCCGTCAGGCGGAGAGTAGCAGTAAGTACAAACTTCTGCTAGTCGCTCTGCCACAACGTAGCCACCTAAGATTAACCCTGGAATTGTCCGGGCGGCATGATCCATCGAGGAGTTAGCGGGGACAGGGAGTTACCAGTCGAGACGTCCATGGTGGTGCTGCAATCCATGGATACCATCTCCTTGCCATTCCTAGGGACATCG
# EXPECT: chrB
# EXPECT: TATGGGGTAGCATCATTAAGTGGGGAGGTAGACCAGGAGTTCGGTTCCCGGAGTTTCGTTAGTTCAGGTAGCGTGACCTCGTCTTAGTATGCAGTCGTGAAATAATAGACATTTCTGCCTGTCAGGTTGCACTAATCACACCCAGGCTGTTAACGAGGCGGCTCGTAGTATAAACGCTTTGGACTAGACTCGATACCTAGCGGCGCGCATTGATAAATGGTGCATCTATAGTAAAAGGCGTCCCAACCTGGGGACTTAGCGTTGAATACCCGTGCAAGGATCTCTAATCGGTTCTCAATGGCTGCCTGCTCTTTCTCTAAACGAGACTCTAATATCATGTGTGGTCCTTGCTTTCGGTCGAGAAAAAGCCTTTGATCGCATCCCAAACCGACATCTAAAAGCTTCATGTATGTCGGCAGCGAAAAAACGACCAAATAGAAGTCCCCTAACGGAGAATAGGCCGCCCACGACAGAACACCGCTTCGTCCT
# EXPECT: chrC
# EXPECT: CCCGCTAGCCGTGCCTGATCCTCAACCAAGCTGGGTAAAGACAACCGTCTAATCATTAACTTACGTTGTTACGTCATTTTGCGCTTAAAATTGTCGCACCGGAATCCGTCGAGACTTCCCGAGACATGTCCCCTTAATAAATGTACGGTGTGACCTAACGATCGGATCACCGTCCGTGCTAAAACACACAACCGCTGCGTGACACCGACCGAACGTTACCGAAGGCTGTCCGCCTAACATCTATATTTGGCGGTAAAGAGGCGGTTCCGGCGGACTATAAAGTCACAGGCCACTGTTTCTTTGCAAGATATGGCTCTCTGTCAGGACCGCCCCCTAGGGTCAGCTCAAATAAGCTTGTCCCGGACTCCGTACTTCCAACAGAAAGGTGACCGCTACATTCTGCTATTGACCCCTCACACAACGTTCCCCCGCATGGCGTACGTGTTACCAGGGCGGTTGCGGCCTTACGTCGCCATAAGCACGTATATAAGTCACCCACT
# EXPECT: chrD
# EXPECT: TGCCGTGACCACCCCGCGAGAATCTCATAATGATATCTCCAATCGAGTA

def print3(r):
    print r.tid, r.locus.pos, r.name, r.read, r.cigar
    aux = r.aux('XX')
    if aux:
        print [aux.B2i(i) for i in range(aux.B_len)]

print '-'  # EXPECT: -
SAM('test/data/toy.sam') |> iter |> print3
# EXPECT: 0 6 r001 TTAGATAAAGAGGATACTG 8M4I4M1D3M
# EXPECT: [12561, 2, 20, 112]
# EXPECT: 0 8 r002 AAAAGATAAGGGATAAA 1S2I6M1P1I1P1I4M2I
# EXPECT: 0 8 r003 AGCTAA 5H6M
# EXPECT: 0 15 r004 ATAGCTCTCAGC 6M14N1I5M
# EXPECT: 0 28 r003 TAGGC 6H5M
# EXPECT: 0 36 r001 CAGCGCCAT 9M
# EXPECT: 1 0 x1 AGGTTTTATAAAACAAATAA 20M
# EXPECT: 1 1 x2 GGTTTTATAAAACAAATAATT 21M
# EXPECT: 1 5 x3 TTATAAAACAAATAATTAAGTCTACA 9M4I13M
# EXPECT: 1 9 x4 CAAATAATTAAGTCTACAGAGCAAC 25M
# EXPECT: 1 11 x5 AATAATTAAGTCTACAGAGCAACT 24M
# EXPECT: 1 13 x6 TAATTAAGTCTACAGAGCAACTA 23M

print '-'  # EXPECT: -
BAM('test/data/toy.bam') |> iter |> print3
# EXPECT: 0 6 r001 TTAGATAAAGAGGATACTG 8M4I4M1D3M
# EXPECT: [12561, 2, 20, 112]
# EXPECT: 0 8 r002 AAAAGATAAGGGATAAA 1S2I6M1P1I1P1I4M2I
# EXPECT: 0 8 r003 AGCTAA 5H6M
# EXPECT: 0 15 r004 ATAGCTCTCAGC 6M14N1I5M
# EXPECT: 0 28 r003 TAGGC 6H5M
# EXPECT: 0 36 r001 CAGCGCCAT 9M
# EXPECT: 1 0 x1 AGGTTTTATAAAACAAATAA 20M
# EXPECT: 1 1 x2 GGTTTTATAAAACAAATAATT 21M
# EXPECT: 1 5 x3 TTATAAAACAAATAATTAAGTCTACA 9M4I13M
# EXPECT: 1 9 x4 CAAATAATTAAGTCTACAGAGCAAC 25M
# EXPECT: 1 11 x5 AATAATTAAGTCTACAGAGCAACT 24M
# EXPECT: 1 13 x6 TAATTAAGTCTACAGAGCAACTA 23M

print '-'  # EXPECT: -
CRAM('test/data/toy.cram') |> iter |> print3
# EXPECT: 0 6 r001 TTAGATAAAGAGGATACTG 8M4I4M1D3M
# EXPECT: [12561, 2, 20, 112]
# EXPECT: 0 8 r002 AAAAGATAAGGGATAAA 1S2I6M1P1I1P1I4M2I
# EXPECT: 0 8 r003 AGCTAA 5H6M
# EXPECT: 0 15 r004 ATAGCTCTCAGC 6M14N1I5M
# EXPECT: 0 28 r003 TAGGC 6H5M
# EXPECT: 0 36 r001 CAGCGCCAT 9M
# EXPECT: 1 0 x1 AGGTTTTATAAAACAAATAA 20M
# EXPECT: 1 1 x2 GGTTTTATAAAACAAATAATT 21M
# EXPECT: 1 5 x3 TTATAAAACAAATAATTAAGTCTACA 9M4I13M
# EXPECT: 1 9 x4 CAAATAATTAAGTCTACAGAGCAAC 25M
# EXPECT: 1 11 x5 AATAATTAAGTCTACAGAGCAACT 24M
# EXPECT: 1 13 x6 TAATTAAGTCTACAGAGCAACTA 23M

print '-'  # EXPECT: -
BAM('test/data/toy.bam', 'ref2') |> iter |> print3
# EXPECT: 1 0 x1 AGGTTTTATAAAACAAATAA 20M
# EXPECT: 1 1 x2 GGTTTTATAAAACAAATAATT 21M
# EXPECT: 1 5 x3 TTATAAAACAAATAATTAAGTCTACA 9M4I13M
# EXPECT: 1 9 x4 CAAATAATTAAGTCTACAGAGCAAC 25M
# EXPECT: 1 11 x5 AATAATTAAGTCTACAGAGCAACT 24M
# EXPECT: 1 13 x6 TAATTAAGTCTACAGAGCAACTA 23M

print '-'  # EXPECT: -
CRAM('test/data/toy.cram', 'ref:30') |> iter |> print3
# EXPECT: 0 15 r004 ATAGCTCTCAGC 6M14N1I5M
# EXPECT: 0 28 r003 TAGGC 6H5M
# EXPECT: 0 36 r001 CAGCGCCAT 9M

opts1 = [True, False]
opts2 = [(a,b) for a in (True, False) for b in (True, False)]
opts3 = [(a,b,c) for a in (True, False) for b in (True, False) for c in (True, False)]
opts4 = [(a,b,c,d) for a in (True, False) for b in (True, False) for c in (True, False) for d in (True, False)]

@test
def test_fasta_options():
    read = list[list[FASTARecord]]()
    for validate, gzip, fai in opts3:
        v = list[FASTARecord]()
        FASTA('test/data/seqs.fasta', validate=validate, gzip=gzip, copy=True, fai=fai) |> iter |> v.append
        read.append(v)
    for a in read:
        assert a == read[0]

@test
def test_fastq_options():
    read = list[list[FASTQRecord]]()
    for validate, gzip in opts2:
        v = list[FASTQRecord]()
        FASTQ('test/data/seqs.fastq', validate=validate, gzip=gzip, copy=True) |> iter |> v.append
        read.append(v)
    for a in read:
        assert a == read[0]

@test
def test_seqs_options():
    read = list[list[seq]]()
    for validate, gzip in opts2:
        v = list[seq]()
        Seqs('test/data/seqs.txt', validate=validate, gzip=gzip, copy=True) |> iter |> v.append
        read.append(v)
    for a in read:
        assert a == read[0]

@test
def test_fasta_options_gz():
    read = list[list[FASTARecord]]()
    for validate in opts1:
        v = list[FASTARecord]()
        FASTA('test/data/seqs.fasta.gz', validate=validate, gzip=True, copy=True, fai=False) |> iter |> v.append
        read.append(v)
    for a in read:
        assert a == read[0]

@test
def test_fastq_options_gz():
    read = list[list[FASTQRecord]]()
    for validate in opts1:
        v = list[FASTQRecord]()
        FASTQ('test/data/seqs.fastq.gz', validate=validate, gzip=True, copy=True) |> iter |> v.append
        read.append(v)
    for a in read:
        assert a == read[0]

@test
def test_seqs_options_gz():
    read = list[list[seq]]()
    for validate in opts1:
        v = list[seq]()
        Seqs('test/data/seqs.txt.gz', validate=validate, gzip=True, copy=True) |> iter |> v.append
        read.append(v)
    for a in read:
        assert a == read[0]

@test
def test_seqs_bad_base():
    found_invalid = False
    for validate, gzip, copy in opts3:
        v = list[seq]()
        try:
            Seqs('test/data/invalid/seqs_bad_base.txt', validate=validate, gzip=gzip, copy=copy) |> iter |> v.append
            assert not validate
        except ValueError as e:
            assert validate
            assert e.message == "invalid base 'Z' at position 74 of sequence"
            found_invalid = True
    assert found_invalid

@test
def test_fasta_bad_base():
    found_invalid = False
    for validate, gzip, fai, copy in opts4:
        v = list[FASTARecord]()
        try:
            FASTA('test/data/invalid/seqs_bad_base.fasta', validate=validate, gzip=gzip, copy=copy, fai=fai) |> iter |> v.append
            assert not validate
        except ValueError as e:
            assert validate
            assert e.message == "invalid base ' ' at position 0 of sequence"
            found_invalid = True
    assert found_invalid

@test
def test_fastq_bad_name():
    found_invalid = False
    for validate, gzip, copy in opts3:
        v = list[seq]()
        try:
            FASTQ('test/data/invalid/seqs_bad_name.fastq', validate=validate, gzip=gzip, copy=copy) |> seqs |> v.append
            assert not validate
        except ValueError as e:
            assert validate
            assert e.message == "sequence name on line 1 of FASTQ does not begin with '@'"
            found_invalid = True
    assert found_invalid

@test
def test_fastq_bad_base():
    found_invalid = False
    for validate, gzip, copy in opts3:
        v = list[seq]()
        try:
            FASTQ('test/data/invalid/seqs_bad_base.fastq', validate=validate, gzip=gzip, copy=copy) |> seqs |> v.append
            assert not validate
        except ValueError as e:
            assert validate
            assert e.message == "invalid base 'X' at position 149 of sequence"
            found_invalid = True
    assert found_invalid

@test
def test_fastq_bad_qual():
    found_invalid = False
    for validate, gzip, copy in opts3:
        v = list[seq]()
        try:
            FASTQ('test/data/invalid/seqs_bad_qual.fastq', validate=validate, gzip=gzip, copy=copy) |> seqs |> v.append
            assert not validate
        except ValueError as e:
            assert validate
            assert e.message == "invalid quality score ' ' at position 0 of quality score string"
            found_invalid = True
    assert found_invalid

@test
def test_fastq_bad_qual_len():
    found_invalid = False
    for validate, gzip, copy in opts3:
        v = list[seq]()
        try:
            FASTQ('test/data/invalid/seqs_bad_qual_len.fastq', validate=validate, gzip=gzip, copy=copy) |> seqs |> v.append
            assert not validate
        except ValueError as e:
            assert validate
            assert e.message == 'quality and sequence length mismatch on line 8 of FASTQ'
            found_invalid = True
    assert found_invalid

@test
def test_fasta_comments():
    v = [(rec.header, rec.name, rec.comment) for rec in FASTA('test/data/seqs.fasta', fai=False)]
    assert v == [('chrA    my random comment', 'chrA', 'my random comment'), ('chrB', 'chrB', ''), ('chrC', 'chrC', ''), ('chrD hello', 'chrD', 'hello')]

@test
def test_fastq_comments():
    v = [(rec.header, rec.name, rec.comment) for rec in FASTQ('test/data/seqs.fastq')]
    assert v == [('SL-HXF:348:HKLFWCCXX:1:2101:15676:57231:CACCAAAAGTACATGA comment A B C', 'SL-HXF:348:HKLFWCCXX:1:2101:15676:57231:CACCAAAAGTACATGA', 'comment A B C'),
                 ('SL-HXF:348:HKLFWCCXX:1:2121:24495:55877:CACCAAAAGTACATGA', 'SL-HXF:348:HKLFWCCXX:1:2121:24495:55877:CACCAAAAGTACATGA', ''),
                 ('SL-HXF:348:HKLFWCCXX:1:2220:28361:38491:CACCAAAAGTACATGA\t\tcomment with tabs', 'SL-HXF:348:HKLFWCCXX:1:2220:28361:38491:CACCAAAAGTACATGA', 'comment with tabs'),
                 ('SL-HXF:348:HKLFWCCXX:4:1106:4553:37893:CACCAAAAGTACATGA', 'SL-HXF:348:HKLFWCCXX:4:1106:4553:37893:CACCAAAAGTACATGA', '')]

@test
def test_fasta_with_fai():
    f = FASTA("test/data/sample_fasta_for_fai.fasta")
    assert f['two'] == s'ATGCATGCATGCATGCATGCATGCATGC'
    assert f['one'] == s'ATGCATGCATGCATGCATGCATGCATGCATGCATGCATGCATGCATGCATGCATGCATGCATGCAT'
    f.close()

test_fasta_options()
test_fastq_options()
test_seqs_options()
test_fasta_options_gz()
test_fastq_options_gz()
test_seqs_options_gz()
test_seqs_bad_base()
test_fastq_bad_qual()
test_fastq_bad_qual_len()
test_fastq_bad_name()
test_fastq_bad_base()
test_fasta_bad_base()
test_fasta_comments()
test_fastq_comments()
test_fasta_with_fai()
